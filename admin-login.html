<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Hack Club — Admin Login</title>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500;700&family=Poppins:wght@300;400;600&family=Inter:wght@300;400;600&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="assets/css/styles.css" />
  <script defer src="assets/js/storage.js"></script>
  <script defer src="assets/js/ui.js"></script>
  <script defer src="assets/js/app.js"></script>
</head>
<body class="theme-gradient">
  <canvas id="bg-canvas" class="bg-canvas"></canvas>
  <header class="navbar">
    <div class="nav-inner">
      <a class="brand" href="https://hackclub.com" target="_blank"><img src="assets/img/logo.svg" alt="Hack Club" /></a>
      <nav class="nav-links">
        <a href="index.html">Home</a>
        <a href="join.html">Join Club</a>
        <a href="sponsors.html">Sponsors</a>
        <a href="projects.html">Projects</a>
        <a href="gallery.html">Gallery</a>
        <a href="hackathons.html">Hackathons</a>
        <a href="meetings.html">Meetings</a>
        <a href="contact.html">Contact</a>
        <a href="donation.html">Donation</a>
        <a href="courses.html">Courses/Videos</a>
        <a href="info.html">Information</a>
        <a href="admin-login.html" class="active">Login</a>
      </nav>
      <button class="nav-toggle" aria-label="Open Menu"><span></span><span></span><span></span></button>
    </div>
  </header>

  <main class="section-pad">
    <div class="container narrow">
      <h1 class="section-title">Admin Login</h1>
      <form id="login-form" class="form card hover-lift">
        <label>Username (email)
          <input type="email" name="username" required />
        </label>
        <label>Password
          <input type="password" name="password" required />
        </label>
        <button class="btn btn-primary" type="submit">Login</button>
      </form>
      <p class="muted center">Default: admin@club.local / hackclub123</p>
      <p class="muted center" id="ctx-note"></p>
    </div>
  </main>

  <footer class="footer simple">
    <div class="container footer-bottom">
      <p>© <span id="year"></span> Hack Club</p>
    </div>
  </footer>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      // If already logged in in this tab, go straight to admin
      try { if (window.StorageAPI.isAuthed()) { location.href = 'admin.html'; return; } } catch {}

      const form = document.getElementById('login-form');
      const note = document.getElementById('ctx-note');

      // Inform if not secure context (we have plain fallback anyway)
      if (!('crypto' in window) || !window.crypto?.subtle) {
        note.textContent = 'Note: Secure crypto not available in this context; using safe fallback to allow login.';
      }

      form.addEventListener('submit', async (e) => {
        e.preventDefault();
        const {username, password} = Object.fromEntries(new FormData(form).entries());
        const ok = await window.StorageAPI.login(username, password);
        if (ok) {
          window.UI.toast('Welcome back!', 'success');
          location.href = 'admin.html';
        } else {
          window.UI.toast('Invalid credentials', 'error');
        }
      });
    });
  </script>
</body>
</html>
